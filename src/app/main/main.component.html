<div [class]="'card-content ' + (mainData['rowClass'] ? mainData['rowClass'] : 'flex flex-wrap')">
    <div class="{{!item.hideExpression   ? item.className : ''}}"
        *ngFor="let item of mainData.children ; index as i; last as isLast">
        <div [ngClass]="{'highLight': item.highLight == true}" *ngIf="!item.hideExpression">
            <span *ngIf="item['comment']">
                <span *ngIf="item['comment'].length > 0">
                    <div [ngStyle]="{'background' : item['commentBackgroundColor'] ? '#3b82f6' : ''}" class="b-comment">
                        <div (click)="toggleCommentDisplay(item)">
                            <ng-container *ngIf="item['commentUser'] && item['commentUser'].length > 1">
                                <nz-avatar-group>
                                    <ng-container *ngFor="let user of item['commentUser']; let i = index">
                                        <nz-avatar style="background: #3b82f6;" *ngIf="i < 2"
                                            [nzText]="typeFirstAlphabetAsIcon(user)"></nz-avatar>
                                    </ng-container>
                                    <nz-avatar *ngIf="item['commentUser'].length > 2" style="background-color: #3b82f6"
                                        nzText="+{{ item['commentUser'].length - 2 }}"></nz-avatar>
                                </nz-avatar-group>
                            </ng-container>
                            <nz-avatar *ngIf="item['commentUser'] && item['commentUser'].length == 1"
                                [nzText]="typeFirstAlphabetAsIcon(item['commentUser'][0])"></nz-avatar>
                        </div>
                        <!-- <div (click)="toggleCommentDisplay(item)" class="user-detail">
                            <h6>{{item['comment'][0].whoCreated}}</h6>
                            <p><span>{{item['comment'][0].dateTime | date : "dd/MMM/yyyy hh:mm"}}</span></p>
                            <p>
                                {{item['comment'][0].comment}}
                            </p>
                            <small>{{item['comment'].length-1}} Replies</small>
                        </div> -->
                        <div class="comment-modal">
                            <nz-drawer [nzWrapClassName]="'comment-drawer'" nzWidth="500px" [nzClosable]="false"
                                [(nzVisible)]="item['showAllComments']" nzPlacement="right" nzTitle="Task Manager"
                                (nzOnClose)="handleCancel(item)">
                                <ng-container *nzDrawerContent>
                                    <!-- <div class="comments-chat">
                                        <div class="c-body">
                                            <div class="comment-box" *ngFor="let comment of item['comment']">
                                                <div class="profile">
                                                    <nz-avatar nzIcon="user" class="mr-2"></nz-avatar>
                                                </div>
                                                <div class="comment">
                                                    <h6>
                                                        {{comment['whoCreated']}} <span>{{comment.dateTime | date :
                                                            "dd/MMM/yyyy hh:mm"}}</span>
                                                    </h6>
                                                    <nz-tag *ngIf="comment['status']"
                                                        [nzColor]="comment['status'] == 'resolved' ? 'blue' : (comment['status'] == 'inProgress' ? 'green' : 'red')">{{comment['status']}}</nz-tag>
                                                    <div class="edit-comment">
                                                        <p>{{comment.comment}}</p>
                                                        <span nz-icon nzType="edit" nzTheme="outline"
                                                            (click)="edit(comment)"></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="c-footer">
                                            <form [formGroup]="commentForm">
                                                <div class="comment-form">
                                                    <label for="status">Status</label>
                                                    <nz-select nzShowSearch nzAllowClear nzPlaceHolder="Select Status"
                                                        formControlName="status">
                                                        <nz-option nzLabel="Open" nzValue="open"></nz-option>
                                                        <nz-option nzLabel="In Progress"
                                                            nzValue="inProgress"></nz-option>
                                                        <nz-option nzLabel="resolved" nzValue="resolved"></nz-option>
                                                    </nz-select>
                                                    <label for="comment">Comment</label>
                                                    <textarea rows="2" formControlName="comment"
                                                        placeholder="Write a message here..." nz-input></textarea>
                                                </div>
                                            </form>
                                            <button (click)="saveComment(item)" *ngIf="!commentEdit" class="mt-2"
                                                nz-button nzType="primary">Save</button>
                                            <button (click)="saveComment(item)" *ngIf="commentEdit" class="mt-2"
                                                nz-button nzType="primary">Update</button>
                                        </div>
                                    </div> -->
                                    <div class="comments-chat">
                                        <div class="c-header">
                                            <div class="arrows">
                                                <!-- <a href="">
                                                    <i class="fa-regular fa-angle-left"></i>
                                                </a>
                                                <a href="">
                                                    <i class="fa-regular fa-angle-right"></i>
                                                </a> -->
                                            </div>
                                            <div class="actions">
                                                <!-- <a href="">
                                                    <i class="fa-solid fa-ellipsis"></i>
                                                </a>
                                                <a href="">
                                                    <i class="fa-regular fa-circle-check"></i>
                                                </a>
                                                <a href="">
                                                    <i class="fa-regular fa-arrow-up-right-from-square"></i>
                                                </a> -->
                                                <a (click)="handleCancel(item)">
                                                    <i class="fa-regular fa-xmark"></i>
                                                </a>
                                            </div>
                                        </div>
                                        <div class="c-body">
                                            <div class="comment-box" *ngFor="let comment of item['comment']">
                                                <div class="profile">
                                                    <nz-avatar nzIcon="user" class="mr-2"></nz-avatar>
                                                </div>
                                                <div class="comment">
                                                    <div class="text-edit">
                                                        <h6>
                                                            {{comment['whoCreated']}} <span>{{comment.dateTime | date :
                                                                "dd/MMM/yyyy hh:mm"}}</span>
                                                            <div class="dot" *ngIf="comment['status']"
                                                                [ngStyle]="{'background' : comment['status'] == 'open' ? 'red' : (comment['status'] == 'resolved' ? 'blue' : 'green')}">
                                                            </div>
                                                        </h6>
                                                        <span>
                                                            <i (click)="edit(comment)"
                                                                class="fa-regular fa-pen-to-square"></i>
                                                        </span>
                                                    </div>
                                                    <p>{{comment.comment}}
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                        <form [formGroup]="commentForm">
                                            <div class="c-footer">
                                                <div class="profile">
                                                    <nz-avatar nzIcon="user" class="mr-2"></nz-avatar>
                                                </div>
                                                <div class="comment">
                                                    <div class="input-group2">
                                                        <input formControlName="comment" type="text"
                                                            class="form-control" placeholder="Reply">
                                                        <div (click)="saveComment(item)" class="send">
                                                            <i class="fa-regular fa-arrow-up"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="status">
                                                    <select formControlName="status" name="" id="">
                                                        <option value="inProgress">In Progress</option>
                                                        <option value="open">Open</option>
                                                        <option value="resolved">Resolved</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </ng-container>
                                <!-- <div *nzModalFooter>
                                    <button (click)="saveComment(item)" *ngIf="!commentEdit" class="mt-2" nz-button
                                        nzType="primary">Save</button>
                                    <button (click)="saveComment(item)" *ngIf="commentEdit" class="mt-2" nz-button
                                        nzType="primary">Update</button>
                                </div> -->
                            </nz-drawer>
                        </div>
                    </div>
                </span>
            </span>
            <span [contextMenu]="oneContextMenu" *ngIf="isShowContextMenu">
                <context-menu #oneContextMenu>
                    <ng-template contextMenuItem (execute)="copyJson(item)"
                        [visible]="isShowContextMenu">Copy</ng-template>
                    <ng-template contextMenuItem (execute)="comment(item)"
                        [visible]="isShowContextMenu">Comment</ng-template>
                </context-menu>
                <st-mains [item]="item" [formlyModel]="formlyModel" [screenName]="screenName" [screenId]="screenId"
                    [isLast]='isLast' [form]="form" *ngIf="item"></st-mains>
            </span>
            <span class="tooltip-icon" *ngIf="item?.tooltipPosition ==  undefined || item?.tooltipPosition == 'top'">
                <span *ngIf="item.type != 'progressBar' && item.type != 'alert'
                    && item.type != 'switch' && item.type != 'rangeSlider' && item.type != 'editor_js' && item?.formlyType != 'input' && item.tooltip
                    && !item?.tooltipWithoutIcon || false" nz-tooltip [nzTooltipTitle]="item.tooltip">
                    <span nz-icon [nzType]="item.tooltipIcon ?  item.tooltipIcon : 'question-circle'"
                        [style.color]="item['toolTipColor']" nzTheme="outline"></span>
                </span>
            </span>
            <div>
                <st-mains [item]="item" [isLast]="isLast" [form]="form" [screenName]="screenName" [screenId]="screenId"
                    *ngIf="item && !isShowContextMenu"></st-mains>

            </div>
        </div>
    </div>
</div>