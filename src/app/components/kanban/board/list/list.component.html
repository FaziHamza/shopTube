<nz-card style="background-color: #f7f8fa; border-radius: 7px;"
  class="!min-w-[300px] list-card w-auto !mr-3 h-full overflow-hidden" (dragover)="allowCardReplacement($event)"
  (drop)="dropCard($event)" id="list-{{listIndex}}">
  <div class="w-full" *ngIf="kanbanData?.allowAdd">
    <div class="flex justify-between items-center text-white bg-green-500 px-2">
      <p
        class="list-name flex items-center text-base font-semibold w-fit !text-left !h-[40px] rounded-md rounded-bl-none rounded-br-none uppercase">
        {{list.title}}</p>
      <i class="fa-solid fa-ellipsis-vertical"></i>
    </div>
    <div class="px-2">
      <button nz-button nzType="primary" (click)="openDrawer('add')"
        [class]="kanbanData?.addButtonClass ? kanbanData?.addButtonClass : 'actions-btn btn-no !border-none !bg-blue-600 hover:!bg-blue-500 my-2 !w-full !h-[40px]'">
        <i class="fa-regular fa-plus mr-2"></i> Add task
      </button>
    </div>
    <!-- <div>
      <span style="color:red" nz-icon nzType="delete" nzTheme="outline" (click)="delete()"></span>
    </div> -->
    <!-- <st-context-menu (contextAction)="delete()"></st-context-menu> -->
  </div>
  <div id="list-one" class="px-2 overflow-auto !h-[calc(100vh-360px)]">
    <div *ngFor="let card of list.children;let i = index ; let isLast = last">
      <!-- <div style="border: 1px solid ; height: 10%;"
        *ngIf="dropListIndex && (dropListIndex == listIndex) && (dropCardIndex == i || list.children.length == dropCardIndex)">
      </div> -->
      <st-card-summary (taskDeleteEmit)="showDeleteConfirm($event)" (taskEditEmit)="edit($event)" [form]="form"
        [kanbanData]="kanbanData" [formlyModel]="formlyModel" [screenId]="screenId" [screenName]="screenName"
        [card]="card" [listIndex]="listIndex" [cardIndex]="i" attr.cardIndex="{{i}}"></st-card-summary>
    </div>
  </div>
</nz-card>

<nz-drawer [nzExtra]="extra" [nzWrapClassName]="'button-drawer'" [nzClosable]=" false"
  [nzTitle]="DrawerType + (mappingId && DrawerType != 'Add'? ' - ' + mappingId : '')" [nzWidth]="'60%'" [nzVisible]="isVisible"
  (nzOnClose)="handleClose()">
  <ng-container *nzDrawerContent>
    <nz-spin [nzSpinning]="loader">
      <st-pages [mappingId]="mappingId" [isDrawer]="DrawerType == 'Add' ? false : true" [data]="nodes"
        [navigation]="screenId" [form]="form" [formlyModel]="formlyModel" *ngIf="nodes.length > 0"></st-pages>
    </nz-spin>
  </ng-container>
</nz-drawer>
<ng-template #extra>
  <i class="fas fa-times text-lg text-red-500 cursor-pointer" (click)="handleClose()"></i>
</ng-template>