<nz-spin [nzSpinning]="saveLoader" [nzSize]="'large'">
  <div *ngIf="showProgressBar" class="progress-container pr-2">
    <nz-progress [nzPercent]="progress" nzStatus="active"></nz-progress>
  </div>

  <!-- <nz-modal [(nzVisible)]="isVisible" nzWidth=700px nzTitle="The first Modal" (nzOnCancel)="handleCancel()">
  <ng-container *nzModalContent>
    <label class="form-label ml-3 text-base font-bold w-3/12">Column Name</label>
    <input nz-input type="text" class="form-control ml-1  w-4/12" placeholder="Enetr Column Name"
      [(ngModel)]="columnName">
  </ng-container>
</nz-modal> -->
  <div *ngIf="data?.isAddRow == undefined ? true: data?.isAddRow" class="p-2 !mt-1.5 bg-white rounded-md">
    <button nz-button (click)="addRow()" *ngIf="!checkType" nzType="primary"> <i class="fa-regular fa-plus mr-2"></i>
      Add</button>
    <button nz-button (click)="addColumn()" *ngIf="checkType" nzType="primary"> <i class="fa-regular fa-plus mr-2"></i>
      Add</button>
  </div>


  <div [ngClass]="{'flex justify-between': data?.heading}">
    <div *ngIf="data?.heading">
      <p [class]="data?.headingClass || 'text-md'">{{data?.heading}}</p>
    </div>
    <div *ngIf="!childTable" class="flex p-1 items-center {{data?.buttonPositions || ' justify-end'}}">
      <!-- <button [style.order]="split(0 , data?.buttonAlignments) || 1" *ngIf="data?.isAllowExcelReport" nz-button
        (click)="exportToExcel()" nzType="primary"
        class="!rounded-md !bg-green-500 !text-white hover:!bg-green-600 !h-[35px] hover:text-white !border !border-transparent !hover:border-transparent font-md text-lg">Download
        Excel<i class="fa-regular fa-download ml-2 mr-2"></i></button>
      <div *ngIf="data?.isAllowUploadExcel" [style.order]="split(1 , data?.buttonAlignments) || 2"
        class="!w-1/5 ml-2 mr-2 !h-[35px]">
      </div> -->
      <button class="btn !mx-2 !h-[35px]" [style.order]="split(0 , data?.buttonAlignments) || 3"
        *ngIf="data?.isShowDrawerButton" nz-button nzType="primary" (click)="open()">
        {{data?.drawerButtonLabel ? data?.drawerButtonLabel : 'Open Drawer'}}</button>
      <nz-drawer [nzPlacement]="data?.drawerPlacement || 'right'" [nzExtra]="extra" [nzWidth]="data?.drawerWidth"
        [nzClosable]="false" [nzVisible]="visible" nzPlacement="right"
        [nzTitle]="data?.drawerButtonLabel ?  data?.drawerButtonLabel : 'Open Drawer'" (nzOnClose)="close()">
        <ng-container *nzDrawerContent>
          <nz-spin [nzSpinning]="saveLoader" [nzSize]="'large'">
            <p *ngIf="!data?.drawerScreenLink">No Link Against this screen</p>
            <st-pages [data]="nodes" [screenName]="screenName" [navigation]="screenId" [form]="form"
              [formlyModel]="formlyModel" *ngIf="nodes.length  > 0 && screenId"></st-pages>
          </nz-spin>
        </ng-container>
      </nz-drawer>
      <ng-template #extra>
        <i class="fas fa-times text-lg text-red-500 cursor-pointer" (click)="close()"></i>
      </ng-template>
      <div class="mr-2 ml-2" [style.order]="split(1 , data?.buttonAlignments) || 2"
        *ngIf="!childTable && (data?.isAllowExcelReport || data?.isAllowUploadExcel)" class="action-drop-down">
        <button nz-button nzType="primary"
          class="actions-btn btn-no !border-none !bg-blue-600 hover:!bg-blue-500 my-2 !h-[35px]" nz-dropdown
          [nzDropdownMenu]="menu4">
          Actions
          <span nz-icon nzType="down"></span>
        </button>
        <nz-dropdown-menu #menu4="nzDropdownMenu" class="action-drop-down-list">
          <ul nz-menu class="!p-2">
            <li nz-menu-item>
              <a (click)="exportToExcel()" class="!text-black">Excel Report Download</a>
            </li>
            <li nz-menu-item>
              <a onclick="document.getElementById('selectedDynamicTableFile').click()" class="!text-black">Import</a>
            </li>
          </ul>
        </nz-dropdown-menu>
        <input [(ngModel)]="fileUpload" type="file" class="form-control !mx-2" id="selectedDynamicTableFile"
          style="display:none" (change)="onFileSelected($event)" accept=".xlsx">
      </div>
      <div [nzTooltipTitle]="
      data?.searchType ? data?.searchType : 'keyup' " nz-tooltip [style.order]="split(2 , data?.buttonAlignments) || 1"
        class="!h-[35px] !mx-2" *ngIf="data?.isAllowSearch">
        <nz-input-group (input)="search(data?.searchType ? 'keyup' : 'keyup')" nzSearch
          [nzAddOnAfter]="suffixIconButton">
          <input type="text" class="!h-[35px] !rounded-tl-md !rounded-bl-md" nz-input id="searchControll"
            [(ngModel)]="data['searchValue']" placeholder="Search..." />
        </nz-input-group>
        <ng-template #suffixIconButton>
          <button (click)="search('onClick')" nz-button nzType="primary"
            class="!rounded-tr-md !rounded-br-md !w-10 !h-[35px] !bg-blue-600 hover:!bg-blue-500" nzSearch>
            <i class="fa-solid fa-magnifying-glass"></i>
          </button>
        </ng-template>
      </div>
    </div>
  </div>
  <div *ngIf="groupingArray.length > 0" class="!flex !justify-start !items-center">
    <label class="mr-2 !font-semibold !text-sm text-blue-500">GROUPED BY :</label>
    <ng-container *ngFor="let group of groupingArray; let last = last ; let i = index">
      <div (click)="removeGrouping(i , false)">
        <!-- <i class="fa-light text-xs text-blue-600 fa-badge-check mr-0.5"></i> -->
        {{ group }}
      </div>
      <i *ngIf="!last" class="fa-solid fa-square-ampersand mx-1.5"></i>
    </ng-container>
    <i (click)="removeGrouping(0 , true)" class="fa-solid fa-square-xmark text-red-500 mx-2"></i>
  </div>

  <div class="dynamic-table" [processData]="processData"
    [appConfigurableSelect]="childTable == false ? (data?.appConfigurableEvent ? data?.appConfigurableEvent : []) : []"
    [loadAction]="childTable == false ? ( data?.eventActionconfig ? data?.eventActionconfig : {}) : false">
    <nz-table nzShowPagination [nzVirtualItemSize]="54" [nzSimple]="true"
      [nzOuterBordered]="data?.outerBordered || false" [nzScroll]="data?.stickyHeaders
    ? {  y: '240px' }
    : (data?.endFreezingNumber !== undefined || data?.startFreezingNumber !== undefined
      ? { x: '2500px' }
      : { x: '' })" [class]="tableHeaders.length > 5 ? 'table-auto' : 'table-fixed' " #columnTable #editRowTable
      #outBordered [nzPageSize]="10" [nzData]="displayData" *ngIf="data && displayData" [nzLoading]="data?.nzLoading"
      [nzPaginationPosition]='data?.nzPaginationPosition' [nzPaginationType]='data?.nzPaginationType'
      [nzFrontPagination]='false' [nzTitle]='data?.nzTitle' [nzSimple]="data.nzSimple"
      [nzShowSizeChanger]="data.nzShowSizeChanger">
      <thead *ngIf="tableHeaders.length > 0" class="desktop-toggle">
        <tr class="desktop-toggle " *ngIf="data?.showColumnHeader == undefined ? true : data?.showColumnHeader">
          <th [nzLeft]="data?.startFreezingNumber >= 1" class="!font-semibold !text-gray-500 !uppercase !text-xs relative before:!inline-block before:!content-[''] before:!absolute before:!h-[2px] before:!w-[150px] before:!bg-black before:!left-[-27px] before:!transform before:!rotate-[{{-rotationDegree+'deg'}}] after:!inline-block after:!content-[''] after:!absolute after:!h-[2px] after:!w-[150px] after:!bg-black after:!right-[-20px] after:!transform after:!rotate-[{{-rotationDegree+'deg'}}] "
            *ngIf="data.showCheckbox" [(nzChecked)]="allChecked" [nzIndeterminate]="indeterminate"
            (nzCheckedChange)="checkAll($event)" [ngStyle]="{'text-align': data?.position || 'left'}"></th>
          <ng-container *ngFor="let header of tableHeaders ; let i = index">
            <!-- !border-r-4 !border-gray-200 -->
            <th  (mousedown)="onResizeStart($event, header)"
              [nzWidth]="header?.width ? header.width + 'px' : 'auto'" [nzLeft]="allowFreeze(header , i)"
              [nzRight]="header?.headerFreeze == true ? true : false"
              class="font-semibold text-gray-500 uppercase text-xs relative before:!inline-block before:!content-[''] before:!absolute before:!h-[2px] before:!w-[150px] before:!bg-black before:!left-[-27px] before:!transform before:!rotate-[{{-rotationDegree+'deg'}}] after:!inline-block after:!content-[''] after:!absolute after:!h-[2px] after:!w-[150px] after:!bg-black after:!right-[-20px] after:!transform after:!rotate-[{{-rotationDegree+'deg'}}] "
              
              *ngIf="header.key !== 'defaultValue' && ( header?.show == true || header?.show === undefined || header?.show === '' || header?.show == 'Yes')"
              [ngStyle]="{'text-align': header?.position || 'left'}">
              <!-- (click)="header?.columnClickApi ? onClickColumn(header.columnClickApi,header): ''" -->
              <div class="head-divider w-auto flex justify-center items-center" [style.transform]="'rotate(-' + rotationDegree + 'deg)'">
                <p class='head-title' >
                  {{header['title'] ? header['title'] : header['name']| translate}}
                </p> 
                <span>
                  <a nz-dropdown [nzDropdownMenu]="menu" *ngIf="header?.isAllowGrouping && !childTable">
                    <i class="fa-regular fa-ellipsis-v mx-1"></i>
                  </a>
                  <nz-dropdown-menu #menu="nzDropdownMenu">
                    <ul nz-menu nzSelectable class="!p-1.5">
                      <li nz-menu-item (click)="groupedFunc(header['key'] , 'add' , header , true)">
                        Grouped By {{ header['title'] ? header['title'] : header['name'] | translate }}
                      </li>
                      <li nz-menu-item (click)="groupedFunc(header['key'], 'remove' , header , true)">
                        Stopped Grouped By {{ header['title'] ? header['title'] : header['name'] | translate }}
                      </li>
                    </ul>
                  </nz-dropdown-menu>
                  <nz-filter-trigger *ngIf="(header?.filtering || header?.sorting ) && !childTable"
                    [(nzVisible)]="header['visible']" [nzDropdownMenu]="filterMenu">
                    <a (click)="makeFilterData(header , true)">
                      <i class="fa-regular fa-filter mx-1"></i>
                    </a>
                  </nz-filter-trigger>
                  <nz-dropdown-menu #filterMenu="nzDropdownMenu">
                    <ul nz-menu nzSelectable class="!rounded-md !text-sm !font-medium dyname">
                      <div *ngIf="header?.sorting">
                        <p (click)="sortingData(header.key , 'asc')"
                          class="p-1.5 !px-5 hover:bg-gray-100 tracking-[0.2px] leading-5">
                          <i class="fa-regular fa-arrow-down-a-z mr-1"></i>
                          Sort A to Z
                        </p>
                        <p class="p-1.5 !px-5 hover:bg-gray-100 tracking-[0.2px] leading-5"
                          (click)="sortingData(header.key , 'desc')">
                          <i class="fa-solid fa-arrow-up-z-a mr-1"></i>
                          Sort Z to A
                        </p>
                        <hr class="mt-2 mx-5">
                      </div>
                      <ng-container *ngIf="header?.filterArray">
                        <ng-container *ngIf="header?.filterArray.length > 0">
                          <nz-input-group class="py-1.5 mt-2 mx-5 !min-w-[210px] !w-auto" [nzSuffix]="suffixIconSearch">
                            <input nz-input placeholder="Search here..." class="!rounded-md"
                              [(ngModel)]="header['searchValue']" (input)="searchFilter(header)" />
                          </nz-input-group>
                          <ng-template #suffixIconSearch>
                            <span nz-icon nzType="search"></span>
                          </ng-template>
                          <br />
                          <div *ngIf="header?.multipleFiltering == true"
                            class="!flex !justify-start !px-5 mt-2 !items-center !font-semibold !text-xs">
                            <p class="text-blue-600 underline cursor-pointer" (click)="selectClearAll(header , true)">
                              Select all</p>
                            <p class="!mx-1 text-blue-600">-</p>
                            <p class="text-blue-600 underline cursor-pointer" (click)="selectClearAll(header , false)">
                              Clear</p>
                          </div>
                          <div class="h-[150px] !mx-5 !mt-2 overflow-y-auto">
                            <ng-container *ngFor="let item of header?.filterArray ">
                              <li class="!p-1 px-0" *ngIf="header?.multipleFiltering == true ; else single"
                                nz-menu-item>
                                <p class="!w-48  !truncate">
                                  {{item.text}}
                                </p>
                                <label class="!ml-2" nz-checkbox [(ngModel)]="item.filter"></label>
                              </li>
                              <ng-template #single>
                                <li (click)="simpleFiltering(item.value , header)" nz-menu-item>
                                  {{item.text}}
                                </li>
                              </ng-template>
                            </ng-container>
                          </div>
                          <div class="w-full flex justify-between items-center mt-2.5 mb-2 px-5">
                            <button nz-button [class]="header?.multipleFiltering == false? '!w-full' : '!w-[49%]'"
                              [ngClass]="checkResetFiltering(header) ? '!text-black' : '!bg-red-600 hover:!bg-red-500 !text-white'"
                              class="btn-no  border-none !h-[30px]" [disabled]="checkResetFiltering(header)"
                              (click)="filter(header , false)"> <i
                                class="fa-regular fa-arrow-rotate-left mr-1.5"></i>Reset</button>
                            <button nz-button nzType="primary" class="btn !w-[49%] !h-[30px]"
                              (click)="filter(header , true)" *ngIf="header?.multipleFiltering == true"><i
                                class="fa-regular fa-floppy-disk mr-1.5"></i>Save</button>
                          </div>
                        </ng-container>
                      </ng-container>
                    </ul>
                  </nz-dropdown-menu>
                </span> <span *ngIf=" header?.gridHeaderSum">({{header?.gridHeaderSum}})</span>
                <!-- <div class="resizer" (mousedown)="onResizeStart($event, header)"></div> -->
              </div>
            </th>
          </ng-container>
          <th *ngIf="isAllowEdit(tableHeaders)"  [nzRight]="data?.endFreezingNumber >= 2"
        
            class="!text-gray-500 relative before:!inline-block before:!content-[''] before:!absolute before:!h-[2px] before:!w-[150px] before:!bg-black before:!left-[-27px] before:!transform before:!rotate-[{{-rotationDegree+'deg'}}] after:!inline-block after:!content-[''] after:!absolute after:!h-[2px] after:!w-[150px] after:!bg-black after:!right-[-20px] after:!transform after:!rotate-[{{-rotationDegree+'deg'}}] !text-center !uppercase">
            <p [style.transform]="'rotate(-' + rotationDegree + 'deg)'" class="">
              Edit 
            </p>
          </th>
          <th [nzRight]="data?.endFreezingNumber >= 1"
            *ngIf="tableHeaders.length > 0 && (data?.isDeleteAllow || data?.isDeleteAllow == undefined)"
            class="!text-gray-500 relative before:!inline-block before:!content-[''] before:!absolute before:!h-[2px] before:!w-[150px] before:!bg-black before:!left-[-25px] before:!transform before:!rotate-[{{-rotationDegree+'deg'}}]  after:!inline-block after:!content-[''] after:!absolute after:!h-[2px] after:!w-[150px] after:!bg-black after:!right-[-20px] after:!transform after:!rotate-[{{-rotationDegree+'deg'}}] !uppercase !text-center">
            <p [style.transform]="'rotate(-' + rotationDegree + 'deg)'" >
              Delete
            </p>
          </th>
        </tr>
      </thead>
      <tbody class="dynamic-responsive-table-body w-full" style="width: 100%;">
        <ng-template #recursiveList let-data1>
          <ng-container *ngFor="let item of data1; let i = index">
            <tr (click)="rowselected(item)" class="desktop-toggle" (dblclick)="updateModel(item)"
              (click)="data?.rowClickApi!='' ? onClickRow(data.rowClickApi,item): ''"
              [ngClass]="{'selectedRow' : item === index }">
              <td [nzLeft]="data?.endFreezingNumber >= 1" *ngIf="item.expand != undefined" [(nzExpand)]="item.expand"
                [ngStyle]="{'text-align': data?.position || 'left'}">
                <p class="pb-1 ">
                  ({{item.children.length}})
                </p>
              </td>
              <td [nzLeft]="data?.startFreezingNumber >= 1" *ngIf="data.showCheckbox"
                [ngStyle]="{'text-align': data?.position || 'left'}">
                <label nz-checkbox [(ngModel)]="item['checked']"></label>
              </td>
              <ng-container *ngFor="let header of data['tableKey']; let index = index">
                <td [ngStyle]="{'text-align': header?.position || 'left'}"
                  [style.width.px]="header.width ? header.width : 'auto'"
                  [class]="header?.headerFreeze == true ? 'TDZINDEX' : ''"
                  [nzLeft]="header?.headerFreeze == true ? true : false"
                  [nzRight]="header?.headerFreeze == true ? true : false" (click)="checkTypeData(item , header)"
                  [nzEllipsis]="true" class="5"
                  [style.border-left]="item[header.key]== item?.colorDataType && editId !== item.id  ?  '4px solid ' + item?.columnColor : ''"
                  *ngIf="(header?.show == true || header?.show === undefined || header?.show === '' || header?.show == 'Yes') && header?.dataType !='objectType' && header.key != 'headerButton' && header.key != 'footerButton' && header.key != 'expandable' && header.key != 'checked'
                  && header.key != 'expand'  && header.key !='children' && header.key != 'defaultValue' ">
                  <div
                    *ngIf="(header?.dataType !='select' || !configurationTable) && header?.dataType !='audioVideoRecorder' && header?.dataType !='image-upload' && header?.dataType != 'repeatSection' && header?.dataType != 'dateTime' && !isMyDataArray(item[header.key]
                  )
                   && header?.subDataType != 'datetime-local' && header?.dataType != 'rangePicker' && header?.dataType !='checkbox'">
                    <div class="editable-cell"
                      [hidden]="editId === item.id && (configurationTable || header?.editMode == 'yes'|| header?.editMode == true)">
                      {{item[header.key] | translate}}
                    </div>
                    <input *ngIf="configurationTable || header?.editMode == 'yes'|| header?.editMode == true"
                      [hidden]="editId !== item.id" type="text" nz-input [(ngModel)]="item[header.key]" />
                  </div>
                  <div *ngIf=" isMyDataArray(item[header.key]) ">
                    <nz-select nzAllowClear nzShowSearch style="width: 100px" nzPlaceHolder="Select Value"
                      [(ngModel)]="item.defaultValue" (ngModelChange)="select(i, $event)">
                      <nz-option *ngFor="let option of item[header.key]"
                        [nzLabel]="option.type ? option.type : option.key"
                        [nzValue]="option.value ? option.value : option">
                      </nz-option>
                    </nz-select>
                  </div>
                  <div *ngIf="header?.dataType == 'repeatSection' || header?.dataType =='select'">
                    <div class="editable-cell" *ngIf="editId != item.id">
                      {{item[header.key] | translate}}
                    </div>
                    <nz-select *ngIf="editId == item.id && (configurationTable || header?.editMode)" nzAllowClear
                      nzShowSearch class="dynamic-selector" style="width: 100px" nzPlaceHolder="Select Value"
                      [(ngModel)]="item[header.key]">
                      <nz-option *ngFor="let option of item[header.key+'_list']" [nzLabel]="option.label "
                        [nzValue]="option.value ">
                      </nz-option>
                    </nz-select>
                  </div>
                  <div *ngIf="header?.dataType =='image-upload'" class="4">
                    <img nz-image class="table-image" *ngIf="item[header.key]" [nzSrc]="serverPath +item[header.key]"
                      alt />
                  </div>
                  <ng-container
                    *ngIf="header?.dataType =='input' && tableHeaders[index]?.subDataType == 'datetime-local'">
                    <ng-container *ngIf="item[header.key]">
                      {{ item[header.key] | date:'dd-MM-yyyy HH:mm:ss'}}
                    </ng-container>
                  </ng-container>
                  <ng-container *ngIf="header?.dataType =='dateTime'">
                    <ng-container *ngIf="item[header.key] && editId != item.id">
                      {{ item[header.key] | date:'dd-MM-yyyy'}}
                    </ng-container>
                    <ng-container *ngIf="editId == item.id && (configurationTable || header?.editMode)">
                      <input [(ngModel)]="item[header.key]" type="date">
                    </ng-container>
                  </ng-container>
                  <ng-container *ngIf="header?.dataType =='objectType'">
                    {{item[header.key]}}
                  </ng-container>
                  <div *ngIf="header?.dataType =='rangePicker'" class="date">
                    {{ transform(item[header.key]) }}
                  </div>
                  <div *ngIf="header?.dataType =='audioVideoRecorder'" class="!h-fit">
                    <audio *ngIf="item[header.key]" class="!w-[224px] !h-[30px]" controls>
                      <source [src]="item[header.key] ? serverPath + '/' + item[header.key] : ''" type="audio/mp3">
                    </audio>
                  </div>
                  <div *ngIf="header?.dataType =='checkbox'" class="4">
                    <label nz-checkbox [(ngModel)]="item[header.key]"></label>
                  </div>
                </td>
                <td *ngIf="header.key == 'headerButton'">
                  <button (click)="showModal('Header')" type="button"
                    class="bg-blue-600 hover:bg-blue-500 text-white font-bold py-1  px-2.5 rounded">
                    Button
                  </button>
                </td>
                <td *ngIf="header.key == 'footerButton'">
                  <button type="button" (click)="showModal('Footer')"
                    class="bg-blue-600 hover:bg-blue-500 text-white font-bold py-1  px-2.5 rounded">
                    Button
                  </button>
                </td>
              </ng-container>
              <td [nzRight]="data?.endFreezingNumber >= 2" *ngIf="isAllowEdit(tableHeaders)" (click)="saveEdit(item)"
                class="!text-center">
                <i class="fa-regular !text-sm fa-save text-blue-500"></i>
              </td>
              <td [nzRight]="data?.endFreezingNumber >= 1"
                *ngIf="data?.isDeleteAllow || data?.isDeleteAllow == undefined" class="!text-center">
                <a (click)="showDeleteConfirm(item)">
                  <i class="fa-regular fa-trash !text-sm text-red-500"></i>
                </a>
              </td>
            </tr>
            <tr *ngIf="item.expand != undefined" [nzExpand]="item.expand">
              <ng-container *ngIf="item?.children && item.expand">
                <dynamic-table [tableId]='item.tableId' [childTable]='true' *ngIf="item?.children.length > 0"
                  [checkType]="false" [tableData]='item?.children' [tableHeaders]='item?.tableHeaders'
                  [formlyModel]="formlyModel" [form]="form" [screenId]="screenId" [data]="data"
                  [displayData]="item?.children" [screenName]="screenName"
                  [configurationTable]="item?.showEditInput ? item?.showEditInput : false"
                  [showPagination]="false"></dynamic-table>
              </ng-container>
            </tr>
            <div (dblclick)="updateModel(item)" class="dynamic-responsive-table mobile-toggle" style="width: 100%;">
              <tr *ngFor="let entryKey of getObjectKeys(item)">
                <ng-container *ngFor="let header of tableHeaders; let index = index">
                  <ng-container *ngIf="header.key == entryKey">
                    <td class="font-bold bg-blue-600 !text-white hover:text-black"
                      [ngStyle]="{'text-align': data?.position || 'left'}">{{header['title'] ?
                      header['title'] :
                      header['name']| translate}}</td>
                    <td *ngIf="entryKey == 'expand'" [(nzExpand)]="item[entryKey]"
                      [ngStyle]="{'text-align': data?.position || 'left'}"></td>
                    <td class="responsive-checkBox" *ngIf="data.showCheckbox && entryKey == 'checked'"
                      [ngStyle]="{'text-align': data?.position || 'left'}" [(nzChecked)]="item.checked"
                      (nzCheckedChange)="refreshStatus()"></td>
                    <td [ngStyle]="{'text-align': data?.position || 'left'}" *ngIf="header?.dataType !='objectType' && header.key != 'headerButton' && header.key != 'footerButton' && header.key != 'expandable' && header.key != 'checked' 
                  && header.key != 'expand' && header.key != 'defaultValue' ">
                      <ng-container class="editable-cell" *ngIf="editingEntry == entryKey && configurationTable">
                        <input nz-input type="text" [(ngModel)]="item[entryKey]">
                      </ng-container>
                      <ng-container *ngIf="editingEntry != entryKey">
                        {{ item[entryKey] }}
                      </ng-container>
                    </td>
                    <td *ngIf="header?.dataType =='select' && configurationTable || isMyDataArray(item[header.key]) "
                      [ngStyle]="{'text-align': data?.position || 'left'}">
                      <nz-select nzAllowClear nzShowSearch style="width: 100px" nzPlaceHolder="Select Value"
                        [(ngModel)]="item.defaultValue" (ngModelChange)="select(i, $event)">
                        <nz-option *ngFor="let option of item[header.key]"
                          [nzLabel]="option.type ? option.type : option.key"
                          [nzValue]="option.value ? option.value : option">
                        </nz-option>
                      </nz-select>
                    </td>
                    <td *ngIf="header?.dataType =='image-upload'" class="4"
                      [ngStyle]="{'text-align': data?.position || 'left'}">
                      <img nz-image width="80px" height="80px"
                        [nzSrc]="item[header.key] ? item[header.key] :'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png'"
                        alt />
                    </td>
                    <td *ngIf="header?.dataType =='input' && tableHeaders[index]?.subDataType == 'datetime-local'"
                      [ngStyle]="{'text-align': data?.position || 'left'}">
                      {{ item[header.key] | date:'dd-MM-yyyy HH:mm:ss'}}
                    </td>
                    <td *ngIf="header?.dataType =='rangePicker'" class="date"
                      [ngStyle]="{'text-align': data?.position || 'left'}">
                      <!-- {{ item[header.key]}} -->
                      {{ transform(item[header.key]) }}
                    </td>
                    <td class="5" *ngIf="header?.dataType =='objectType'"
                      [ngStyle]="{'text-align': data?.position || 'left'}"
                      [ngStyle]="{'border-left':'4px solid ' + tableHeaders[index]?.columnColor}">
                      {{tableHeaders[index]?.columnColor}}
                      {{item[header.key]}}
                    </td>
                  </ng-container>
                </ng-container>
              </tr>
              <tr *ngIf="data?.isDeleteAllow || data?.isDeleteAllow == undefined">
                <td class="font-bold bg-blue-500 text-white hover:text-black"
                  [ngStyle]="{'text-align': data?.position || 'left'}">Action</td>
                <td [ngStyle]="{'text-align': data?.position || 'left'}">
                  <a nz-popconfirm nzPopconfirmTitle="Sure to delete?" (nzOnConfirm)="deleteRow(item)">
                    <i class="fa-regular fa-trash !text-red-500"></i>
                  </a>
                </td>
              </tr>
              <br>
            </div>
          </ng-container>
        </ng-template>
        <ng-container *ngTemplateOutlet="recursiveList; context:{ $implicit: editRowTable.data }"></ng-container>
      </tbody>
      <tfoot *ngIf="data?.nzFooter && !responsiveTable" class="bg-gray-100">
        <tr nz-custom-footer>
          {{data?.nzFooter}}
          <td nzWidth="40px" *ngIf="data.expandable"></td>
          <td *ngIf="data.showCheckbox" nzWidth="60px"></td>
          <td *ngFor="let header of footerData"> <span *ngIf="header.gridFooterSum">
              ({{header.gridFooterSum}})</span>
          </td>
        </tr>
      </tfoot>
    </nz-table>
    <div [ngClass]="{'flex': data?.changePageSize && data.totalCount > data?.end}">
      <div class="paginatio-bottom !mt-1.5"
        *ngIf="data?.nzShowPagination && data.totalCount > data?.end && showPagination">
        <div>
          <p class="showing">Showing <span>{{start}} - {{end ? end : data?.end}}</span>
            <span *ngIf="data.showTotal || data.showTotal == undefined">
              <span class="!text-black">
                from
              </span>
              <span>{{data.totalCount}}</span> <span class="!text-black">
                data
              </span>
            </span>
          </p>
        </div>
        <nz-pagination [nzTotal]="data.totalCount" [(nzPageIndex)]="data.pageIndex"
          [(nzPageSize)]="pageSize ? pageSize : data.end" (nzPageSizeChange)="check($event)"
          (nzPageIndexChange)="onPageIndexChange($event)">
        </nz-pagination>
      </div>
      <div *ngIf="data?.changePageSize">
        <a class="flex justify-start items-center border border-gray-100 text-black hover:text-blue-600 hover:border-blue-600" nz-dropdown [nzDropdownMenu]="menu11">
          <p class="white" sty >
            Row Per Table 
          </p>
          <span nz-icon nzType="down"></span>
        </a>
        <nz-dropdown-menu #menu11="nzDropdownMenu">
          <ul nz-menu nzSelectable>
            <li nz-menu-item (click)="changePageSize(10)">10/page</li>
            <li nz-menu-item (click)="changePageSize(20)">20/Page</li>
            <li nz-menu-item (click)="changePageSize(30)">30/Page</li>
            <li nz-menu-item (click)="changePageSize(40)">40/Page</li>
            <li nz-menu-item (click)="changePageSize(50)">50/Page</li>
            <li nz-menu-item (click)="changePageSize(60)">60/Page</li>
            <li nz-menu-item (click)="changePageSize(70)">70/Page</li>
            <li nz-menu-item (click)="changePageSize(80)">80/Page</li>
            <li nz-menu-item (click)="changePageSize(90)">90/Page</li>
            <li nz-menu-item (click)="changePageSize(100)">100/Page</li>
          </ul>
        </nz-dropdown-menu>
      </div>
    </div>
  </div>


  <div class="p-[6px] pl-0">
    <button nz-button *ngIf="configurationTable" (click)="save()" nzType="primary"> <i
        class="fa-regular fa-floppy-disk mr-2"></i> Save Change</button>
  </div>
  <nz-modal [nzWidth]="1400" [(nzVisible)]="isHeaderVisible" nzTitle="Grid Rule" (nzOnCancel)="handleCancel()"
    (nzOnOk)="handleOk()">
    <ng-container *nzModalContent>
      <st-business-rule-grid [GridType]="GridType" [selectedNode]="_dataSharedService.selectedNode"
        [screenName]="screenName" [screenId]="screenId" [screens]="_dataSharedService.screenModule"
        [nodes]="_dataSharedService.nodes"></st-business-rule-grid>
    </ng-container>
  </nz-modal>

  <!-- <div *ngIf="this.issueReport['issueReport'] && this.issueReport['issueReport']?.length  > 0">
  <st-task-report (notify)="updateIssues($event)" class="close-icon" [item]="this.issueReport"
    [screenName]="this.issueReport['issueReport'][0].screenId" [assignToresponse]="this.assignToresponse"
    [type]="'userTaskManagement'" [userTaskManagementData]="tasks"></st-task-report>
</div> -->
</nz-spin>
<ng-container *ngIf="data && showChild">
  <ng-container *ngIf="data.children">
    <st-main [mainData]="data" *ngIf="data?.children.length > 0 && !configurationTable" [screenName]="screenName"
      [form]="form" [formlyModel]="formlyModel"></st-main>
  </ng-container>
</ng-container>