<div #monacoComponent></div>
<div class="general_faq mt-3">
  <form [formGroup]="actionForm">
    <div class="grid lg:grid-cols-5 sm:grid-cols-2 gap-2">
      <div>
        <nz-select class="form-select" formControlName="submissionType" aria-label="Default Select Example">
          <nz-option nzValue="-1" nzLabel="Select" selected></nz-option>
          <nz-option nzValue="onLoad" nzLabel="On Load" selected></nz-option>
          <nz-option nzValue="onClick" nzLabel="On Click" selected></nz-option>
        </nz-select>
      </div>
      <div>
        <nz-select class="form-select" formControlName="actionLink" aria-label="Default Select Example">
          <nz-option nzValue="get" nzLabel="GET"></nz-option>
          <nz-option nzValue="getJoin" nzLabel="GET Join"></nz-option>
          <nz-option nzValue="post" nzLabel="POST"></nz-option>
          <nz-option nzValue="put" nzLabel="PUT"></nz-option>
          <nz-option nzValue="delete" nzLabel="DELETE"></nz-option>
        </nz-select>
      </div>
      <div>
        <nz-select class="form-select" formControlName="elementName" aria-label="Default Select Example">
          <nz-option [nzLabel]="item.title" [nzValue]="item.key" *ngFor="let item of nodeList"></nz-option>
        </nz-select>
      </div>
      <div>
        <nz-select class="form-select" formControlName="actionType" aria-label="Default Select Example">
          <nz-option nzValue="-1" nzLabel="Select" selected></nz-option>
          <nz-option nzValue="email" nzLabel="Email"></nz-option>
          <nz-option nzValue="query" nzLabel="Query"></nz-option>
          <nz-option nzValue="api" nzLabel="Http"></nz-option>
          <nz-option nzValue="confirmEmail" nzLabel="Confirm Email"></nz-option>
        </nz-select>
      </div>
      <div>
        <button nz-button nzType="primary" (click)="addActionFormGroup()">
          <span nz-icon nzType="plus" nzTheme="outline"></span>
          Add Action
        </button>
      </div>
    </div>

    <div class="mb-3" formArrayName="Actions">
      <ng-container *ngFor="let ActionForm of ActionsForms.controls; let i = index">
        <div class="flex flex-wrap mt-1" style="border: 1px solid rgb(197 187 187); border-radius: 5px;"
          [formGroupName]="i">
          <div class="w-10/12 p-1">
            <div *ngIf="ActionsForms.value[i].type == 'email'">
              <nz-form-label [nzSm]="6" [nzXs]="24">Email</nz-form-label>
              <nz-radio-group class="ml-2" formControlName="sqlType" nzButtonStyle="solid"
                (ngModelChange)="changePostgress(ActionsForms.value[i].type, i)">
                <label nz-radio-button nzValue="sql">Sql</label>
                <label nz-radio-button nzValue="mySql">MySql</label>
                <label nz-radio-button nzValue="postgress">Postgress</label>
              </nz-radio-group>
              <input nz-input type="text" formControlName="referenceId" style="width: 18%;margin-bottom: 1%;">
              <ngx-monaco-editor class="textEditorContainer" [options]="editorOptions" formControlName="email"
                (init)="editorInit($event)"></ngx-monaco-editor>
            </div>
            <div *ngIf="ActionsForms.value[i].type == 'query'">
              <nz-form-label [nzSm]="6" [nzXs]="24">Query</nz-form-label>
              <input nz-input type="text" formControlName="referenceId" class="form-control"
                style="width: 18%;margin-bottom: 1%;">
              <nz-radio-group class="ml-2" formControlName="sqlType" nzButtonStyle="solid"
                (ngModelChange)="changePostgress(ActionsForms.value[i].type, i)">
                <label nz-radio-button nzValue="sql">Sql</label>
                <label nz-radio-button nzValue="mySql">MySql</label>
                <label nz-radio-button nzValue="postgress">Postgress</label>
              </nz-radio-group>
              <ngx-monaco-editor class="textEditorContainer" [options]="editorOptions" [id]="'query' + i"
                formControlName="query" (init)="editorInit($event)"></ngx-monaco-editor>
            </div>
            <div *ngIf="ActionsForms.value[i].type == 'api'">
              <div class="w-full pl-2">
                <div class="flex flex-wrap">
                  <div class="w-1/2 theme-body">
                    <div class=" flex flex-wrap">
                      <label class="w-1/3 py-2 col-form-label column-form-label">
                        Http Address
                      </label>
                      <div class="w-2/3 column-form-input form-control-style v-body-border" style="padding: 0px">
                        <input nz-input type="text" placeholder="Enter value" id="httpAddress{{i}}"
                          formControlName="httpAddress" required class="form-control" name="httpAddress{{i}}" />
                      </div>
                    </div>
                  </div>
                  <div class="w-1/2 theme-body">
                    <div class=" flex flex-wrap">
                      <label class="w-1/3 py-2 col-form-label column-form-label">
                        Content Type
                      </label>
                      <div class="w-2/3 column-form-input form-control-style v-body-border" style="padding: 0px">
                        <nz-select nzShowSearch nzAllowClear formControlName="contentType">
                          <nz-option nzLabel="Text" nzValue="application/text"></nz-option>
                          <nz-option nzLabel="Json" nzValue="application/json"></nz-option>
                          <nz-option nzLabel="Raw" nzValue="application/raw"></nz-option>
                        </nz-select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div *ngIf="ActionsForms.value[i].type == 'confirmEmail'">
              <nz-form-label [nzSm]="6" [nzXs]="24">Confirm Email</nz-form-label>
              <nz-radio-group class="ml-2" formControlName="sqlType" nzButtonStyle="solid"
                (ngModelChange)="changePostgress(ActionsForms.value[i].type, i)">
                <label nz-radio-button nzValue="sql">Sql</label>
                <label nz-radio-button nzValue="mySql">MySql</label>
                <label nz-radio-button nzValue="postgress">Postgress</label>
              </nz-radio-group>
              <input nz-input type="text" formControlName="referenceId" style="width: 18%;margin-bottom: 1%;">
              <ngx-monaco-editor class="textEditorContainer" [options]="editorOptions" [id]="'confirmEmail' + i"
                formControlName="confirmEmail" (init)="editorInit($event)"></ngx-monaco-editor>
            </div>
          </div>
          <div class="w-2/12 " style="margin-top: 7%;">
            <button nz-button nzType="primary" nzDanger (click)="removeActionFormGroup(i,ActionsForms.value[i])">
              <span nz-icon nzType="delete" nzTheme="outline"></span>
            </button>
            <button nz-button nzType="primary" nzDanger class="ml-2"
              (click)="duplicateActionFormGroup(i,ActionsForms.value[i].type)">
              <span nz-icon nzType="copy" nzTheme="outline"></span>
            </button>

          </div>
        </div>
      </ng-container>
    </div>

    <button nz-button nzType="primary" (click)="SaveAction()" class="mt-2"><span nz-icon nzType="save"
        nzTheme="outline"></span>
      Save</button>
  </form>
</div>